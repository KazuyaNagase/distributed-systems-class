!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=require("crypto")},function(t,e){t.exports=require("net")},function(t,e,n){"use strict";n.r(e);var o=n(0),i=function(){function t(t){this.size=6;var e=("0000"+t[0].toString(16)+t[1].toString(16)).slice(-4);"0000"===e?this.type="tcp":"ffff"===e&&(this.type="udp"),this.version=parseInt(t[2].toString(16)+t[3].toString(16)),this.ttl=parseInt(t[4].toString(16)+t[5].toString(16))}return t.prototype.output=function(){console.log("\n--- layer1 -------------"),console.log("type ------ "+this.type),console.log("version --- "+this.version),console.log("ttl ------- "+this.ttl),console.log("--- end ----------------\n")},t}(),r=function(){function t(t,e){if(this.size=4,this.isSafe=!0,this.type=t[0].toString(16)+t[1].toString(16),this.len=parseInt(t[2].toString(16)+t[3].toString(16)),"tcp"===e){this.digest=("00000000"+t[4].toString(16)+t[5].toString(16)+t[6].toString(16)+t[7].toString(16)).slice(-8);var n=Buffer.from(t.slice(8,t.length)),o=("00000000"+this.md5hex(n)).slice(-8);this.isSafe=this.digest===o,this.size+=4}}return t.prototype.output=function(){console.log("\n--- layer2 -------------"),console.log("type ------ "+this.type),console.log("len ------- "+this.len),this.digest&&console.log("digest ------- "+this.digest),console.log("--- end ----------------\n")},t.prototype.md5hex=function(t){var e=o.createHash("md5");return e.update(t),e.digest("hex")},t}(),s=function(){function t(t){this.payload=t}return t.prototype.output=function(){console.log("\n--- payload -------------"),console.log(this.payload),console.log("--- end ----------------\n")},t}(),l=n(1).createServer();l.maxConnections=10;var c={},u=0;l.on("connection",function(t){++u,console.log("--- client No."+u+" connection starts "),t.on("data",function(e){var n=new i(e);n.output();var o=e.slice(n.size,e.length),l=new r(o,n.type);if(l.isSafe){l.output();var c=e.slice(n.size+l.size,e.length);new s(c).output(),t.end()}else t.end()}),t.on("close",function(){console.log("--- client No."+u+" connection end "),u--})}),l.on("close",function(){console.log("Server Closed")}),process.on("SIGINT",function(){for(var t in c){c[t].socket.end()}l.close()}),l.on("listening",function(){var t=l.address();console.log("Listening Start on Server --- "+t.address+"-"+t.port+"-------------------")}),l.listen(2434,"127.0.0.1")}]);